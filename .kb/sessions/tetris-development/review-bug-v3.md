# 코드 리뷰 및 버그 리포트 3: 테트리스 게임 로직

## 버전
- **대상 파일**: `src/main.cpp`, `src/board.cpp`, `src/piece.cpp` (v3)

## 문제점
- **현상**: 게임이 종료 조건(블록이 천장까지 쌓임)에 도달해도 끝나지 않고, 무한 루프에 빠진다.
- **원인 분석**: `isGameOver()` 조건이 올바르게 감지되지 않는 것으로 보인다. 새로운 블록이 생성된 직후, 해당 블록의 위치가 유효하지 않을 때(즉, 기존 블록과 겹칠 때) 게임이 종료되어야 한다. 현재 `update()` 함수나 `isGameOver()` 함수의 로직에 이 조건을 제대로 처리하지 못하는 결함이 있는 것으로 추정된다.

## 수정 요구사항
- 게임의 핵심 로직, 특히 다음 함수들의 상호작용을 면밀히 검토하고 수정해야 한다:
  1.  `spawnNewBlock()`: 새로운 블록을 생성하는 기능
  2.  `placeBlock()`: 블록을 보드에 고정시키는 기능
  3.  `isValidPosition()`: 블록의 위치가 유효한지 검사하는 기능
  4.  `isGameOver()`: 게임 종료 조건을 정확히 판단하는 기능
  5.  `run()` / `update()`: 전체 게임 루프를 제어하는 기능

- **핵심 수정 포인트**: 새로운 블록이 생성된 직후, `isValidPosition()`을 호출하여 게임 오버 여부를 즉시 판단하고, 만약 게임 오버라면 `while` 루프가 종료되도록 로직을 수정해야 한다.

## 요청
위 분석 내용을 바탕으로, 게임이 정상적으로 종료되도록 관련 소스 코드들을 수정해주십시오. 수정된 파일은 기존 파일을 덮어써주세요.
