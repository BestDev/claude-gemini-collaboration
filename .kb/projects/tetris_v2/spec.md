# C++ Cross-Platform Tetris Game: Implementation Specification

## 1. Project Overview

This document provides the detailed technical specification for implementing a cross-platform Tetris game in C++. The goal is to create a robust, maintainable, and classic Tetris experience for both Windows and Linux platforms.

- **Project Name:** TetrisV2
- **Language:** C++17
- **Target Platforms:** Windows, Linux
- **Core Features:**
    - Standard Tetris gameplay (falling tetrominoes, rotation)
    - Line clearing and scoring
    - Increasing difficulty (level system)
    - Game state management (Menu, In-Game, Game Over)

## 2. Technology Stack

- **Graphics & Windowing:** **SFML (Simple and Fast Multimedia Library)**
    - **Reasoning:** SFML provides a simple, object-oriented API for 2D graphics, windowing, and input handling that is well-documented and works seamlessly across Windows and Linux. It abstracts away the platform-specific complexities.
- **Build System:** **CMake**
    - **Reasoning:** CMake is the industry standard for cross-platform C++ project configuration. It allows us to define the build process once and generate native build files (e.g., Makefiles on Linux, Visual Studio solutions on Windows).
- **Compiler:** A C++17 compliant compiler (e.g., GCC, Clang, MSVC).

## 3. Project Structure

The project will follow a standard C++ directory structure to keep source code, headers, assets, and build files organized.

```
tetris_v2/
├── assets/
│   ├── fonts/
│   │   └── arial.ttf         # Or any other suitable font
│   └── sounds/
│       ├── clear.wav
│       └── gameover.wav
├── build/                    # Build files (generated by CMake)
├── include/
│   └── TetrisV2/
│       ├── Board.h
│       ├── Constants.h
│       ├── Game.h
│       ├── Renderer.h
│       └── Tetromino.h
├── src/
│   ├── Board.cpp
│   ├── Game.cpp
│   ├── main.cpp
│   ├── Renderer.cpp
│   └── Tetromino.cpp
├── .gitignore
├── CMakeLists.txt
└── README.md
```

## 4. Core Classes and Components

### 4.1. `Constants.h`
A header file for defining game-wide constants to avoid magic numbers.

- **Contents:**
    - `BOARD_WIDTH`, `BOARD_HEIGHT`: Dimensions of the game board in blocks.
    - `BLOCK_SIZE`: Size of a single block in pixels.
    - `WINDOW_WIDTH`, `WINDOW_HEIGHT`: Window dimensions.
    - `FRAME_RATE_LIMIT`: To control game speed.

### 4.2. `Tetromino.h` / `Tetromino.cpp`
Represents a single Tetris piece (tetromino).

- **Responsibilities:**
    - Store the shape and color of a specific tetromino type (I, O, T, S, Z, J, L).
    - Handle rotation logic.
    - Store its current position on the board.
- **Public Interface:**
    ```cpp
    class Tetromino {
    public:
        Tetromino(TetrominoType type);
        void rotate();
        void move(int dx, int dy);
        sf::Vector2i getPosition() const;
        const std::vector<sf::Vector2i>& getBlocks() const; // Relative block positions
        sf::Color getColor() const;
    private:
        // ...
    };
    ```

### 4.3. `Board.h` / `Board.cpp`
Represents the game grid.

- **Responsibilities:**
    - Maintain the state of the grid (which cells are filled).
    - Check for collisions (with walls or other pieces).
    - Place tetrominoes onto the grid when they land.
    - Detect and clear completed lines.
    - Store the grid of landed blocks.
- **Public Interface:**
    ```cpp
    class Board {
    public:
        Board();
        bool isCollision(const Tetromino& tetromino) const;
        void placePiece(const Tetromino& tetromino);
        int clearLines();
        const std::vector<std::vector<sf::Color>>& getGrid() const;
    private:
        // ...
    };
    ```

### 4.4. `Renderer.h` / `Renderer.cpp`
Handles all drawing operations.

- **Responsibilities:**
    - Draw the game board grid.
    - Draw the currently falling tetromino.
    - Draw the landed blocks.
    - Render text for score, level, and game-over messages.
- **Public Interface:**
    ```cpp
    class Renderer {
    public:
        Renderer(sf::RenderWindow& window);
        void drawBoard(const Board& board);
        void drawTetromino(const Tetromino& tetromino);
        void drawText(const std::string& text, sf::Vector2f position);
    private:
        sf::RenderWindow& m_window;
        sf::Font m_font;
        // ...
    };
    ```

### 4.5. `Game.h` / `Game.cpp`
The main game engine.

- **Responsibilities:**
    - Own the main game loop.
    - Manage game state (Playing, Paused, GameOver).
    - Handle user input (moving/rotating pieces).
    - Manage game logic progression (spawning new pieces, gravity).
    - Keep track of score and level.
    - Initialize and own the `Board`, `Renderer`, and current `Tetromino`.
- **Public Interface:**
    ```cpp
    class Game {
    public:
        Game();
        void run(); // Main game loop
    private:
        void processInput();
        void update();
        void render();
        void spawnNewPiece();

        sf::RenderWindow m_window;
        Board m_board;
        Renderer m_renderer;
        Tetromino m_currentPiece;
        // ... game state, score, level
    };
    ```

### 4.6. `main.cpp`
The entry point of the application.

- **Responsibilities:**
    - Create a `Game` object.
    - Call the `run()` method to start the game.

## 5. Build Configuration (CMake)

The `CMakeLists.txt` file will define the project, find dependencies, and specify the executable.

```cmake
# CMakeLists.txt
cmake_minimum_required(VERSION 3.10)
project(TetrisV2)

# Set C++ standard
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Find SFML package
find_package(SFML 2.5 COMPONENTS graphics window system REQUIRED)

# Include directories
include_directories(include)

# Add source files
file(GLOB_RECURSE SOURCES "src/*.cpp")

# Add the executable
add_executable(tetris_v2 ${SOURCES})

# Link SFML libraries
target_link_libraries(tetris_v2 sfml-graphics sfml-window sfml-system)

# Copy assets to build directory (optional, but good practice)
file(COPY assets DESTINATION ${CMAKE_BINARY_DIR})
```

## 6. Documentation and README

- **Code Comments:** Use Doxygen-style comments for all public classes, methods, and non-trivial code sections.
    ```cpp
    /**
     * @brief Represents the main game board and its state.
     * 
     * This class manages the grid of landed blocks, checks for collisions,
     * and handles line clearing logic.
     */
    class Board { ... };
    ```
- **README.md:** The `README.md` file should include:
    - A brief project description.
    - **Dependencies:** (e.g., SFML 2.5 or higher).
    - **How to Build:**
        - Prerequisite installation (CMake, C++ compiler, SFML).
        - Step-by-step build commands for Linux and Windows.
    - **How to Play:** Basic game controls.

## 7. Implementation Steps for Claude

1.  **Setup:** Create the project structure and `CMakeLists.txt` as defined above.
2.  **Constants:** Implement `Constants.h`.
3.  **Core Logic (Bottom-up):**
    - Implement `Tetromino.h/.cpp` with rotation logic.
    - Implement `Board.h/.cpp` with collision and line clearing.
4.  **Rendering:** Implement `Renderer.h/.cpp` to draw the board and pieces.
5.  **Game Loop:** Implement `Game.h/.cpp` to tie everything together.
6.  **Entry Point:** Create `main.cpp`.
7.  **Documentation:** Add Doxygen comments and write the `README.md`.
